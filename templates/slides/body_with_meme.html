{% extends "base.html" %}

{% block extra_styles %}
<style>
    .split-content {
        display: flex;
        flex-direction: {{ 'column' if meme_position == 'bottom' else 'column-reverse' if meme_position == 'top' else 'row' }};
        height: 100%;
        padding: 50px;
        gap: 30px;
        box-sizing: border-box;
    }

    /* Horizontal layout (meme left/right) */
    .split-content.horizontal {
        flex-direction: row;
        align-items: center;
    }

    .split-content.horizontal .text-section {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
        max-height: 100%;
        overflow: hidden;
    }

    .split-content.horizontal .meme-section {
        flex: 1;
        display: flex;
        align-items: center;
        justify-content: center;
        max-height: 100%;
    }

    /* Vertical layout (meme top/bottom) - MEME DOMINANT */
    .split-content.vertical {
        flex-direction: column;
    }

    .split-content.vertical.meme-top {
        flex-direction: column;
    }

    .split-content.vertical.meme-bottom {
        flex-direction: column;
    }

    .split-content.vertical .text-section {
        flex: 0 0 auto;
        display: flex;
        flex-direction: column;
        justify-content: center;
        padding: 0 20px;
        max-height: 350px;
        overflow: hidden;
    }

    .split-content.vertical .meme-section {
        flex: 1 1 auto;
        min-height: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
    }

    /* Body text - responsive sizing */
    .body-text {
        font-size: clamp(24px, 3vw, 38px);
        font-weight: 600;
        line-height: 1.35;
        color: var(--text-primary);
        text-align: {{ text_align|default('center') }};
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 6;
        -webkit-box-orient: vertical;
    }

    .body-text.small {
        font-size: clamp(22px, 2.8vw, 34px);
    }

    .body-text.long {
        font-size: clamp(20px, 2.5vw, 30px);
        -webkit-line-clamp: 8;
    }

    .body-text.very-long {
        font-size: clamp(18px, 2.2vw, 26px);
        line-height: 1.3;
        -webkit-line-clamp: 10;
    }

    /* Meme container - NO CLIPPING */
    .meme-container {
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
    }

    .meme-container img {
        max-width: 100%;
        max-height: 100%;
        width: auto;
        height: auto;
        object-fit: contain;
        display: block;
    }

    /* Slide badge */
    .slide-badge {
        position: absolute;
        top: 35px;
        right: 45px;
        font-size: 14px;
        font-weight: 600;
        color: var(--text-secondary);
        opacity: 0.5;
    }
</style>
{% endblock %}

{% block content %}
{% if show_slide_badge %}
<div class="slide-badge">{{ slide_number }}/{{ total_slides }}</div>
{% endif %}

<div class="split-content {{ 'horizontal' if meme_position in ['left', 'right'] else 'vertical' }} {{ 'meme-top' if meme_position == 'top' else 'meme-bottom' if meme_position == 'bottom' else '' }}">

    {% if meme_position in ['top', 'left'] %}
    <div class="meme-section">
        <div class="meme-container">
            <img src="{{ meme_path }}" alt="Meme">
        </div>
    </div>
    {% endif %}

    <div class="text-section">
        <p class="body-text {{ text_size_class|default('') }}">
            {{ formatted_text|safe }}
        </p>
    </div>

    {% if meme_position in ['bottom', 'right'] %}
    <div class="meme-section">
        <div class="meme-container">
            <img src="{{ meme_path }}" alt="Meme">
        </div>
    </div>
    {% endif %}

</div>
{% endblock %}
